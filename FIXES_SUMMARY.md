# 버그 수정 요약

## 수정 일시
2025-01-18

## 수정된 문제

### 1. 태그 입력 시 마지막 글자가 입력창에 남는 문제
**문제**: Enter 키로 태그를 입력할 때 마지막 글자가 입력창에 남음

**원인**: `addTag()` 함수에서 입력값을 비우기 전에 Enter 키 이벤트가 처리됨

**수정 내용**:
- `keydown` 이벤트 리스너에서 Enter 키 입력 시 입력값을 먼저 저장하고 즉시 입력 필드를 비움
- `addTag()` 함수에서도 입력 필드를 비우는 로직 강화

**수정 파일**: `lunch-service/lunch.js`
- 라인 348-356: keydown 이벤트 리스너 수정
- 라인 546-581: addTag 함수 수정

### 2. 비밀번호 모달이 매번 표시되지 않는 문제
**문제**: 한 번 비밀번호를 입력하면 이후에는 모달이 표시되지 않음

**원인**: 세션 스토리지(`sessionStorage`)에 인증 상태를 저장하여 브라우저 세션 동안 유지됨

**수정 내용**:
- 등록 탭 클릭 시 세션 스토리지 확인 로직 제거
- 항상 비밀번호 모달을 표시하도록 수정
- 비밀번호 검증 성공 시에도 세션 스토리지에 저장하지 않음

**수정 파일**: `lunch-service/lunch.js`
- 라인 38-45: 탭 전환 로직 수정
- 라인 113-115: 비밀번호 검증 성공 시 세션 스토리지 저장 제거

### 3. "알 수 없는 엔드포인트" 에러 (PUT/DELETE 요청)
**문제**: 관리자 화면에서 수정/삭제 시 "알 수 없는 엔드포인트" 에러 발생

**원인**: Apps Script의 라우팅 로직에서 POST로 변환된 PUT/DELETE 요청을 제대로 처리하지 못함

**수정 내용**:
- Apps Script의 `handleRequest` 함수에서 원본 메서드(`request.parameter.method`) 확인 로직 개선
- `places/{id}` 경로 처리 로직을 더 명확하게 수정
- 에러 메시지에 디버깅 정보 추가

**수정 파일**: `lunch-service/apps-script-template.js`
- 라인 645-660: 라우팅 로직 개선

### 4. 이미지 업로드 "알 수 없는 엔드포인트" 에러
**문제**: 이미지 업로드 시 "알 수 없는 엔드포인트" 에러 발생

**원인**: 이미지 업로드 요청의 디버깅 로그 부족 및 에러 처리 개선 필요

**수정 내용**:
- 이미지 업로드 요청/응답에 상세한 디버깅 로그 추가
- 에러 메시지 개선

**수정 파일**: `lunch-service/lunch.js`
- 라인 669-698: 이미지 업로드 로직 개선

### 5. 관리자 기능 디버깅 로그 추가
**수정 내용**:
- `deletePlace()` 함수에 상세한 디버깅 로그 추가
- `submitPlace()` 함수의 수정 요청에 디버깅 로그 추가

**수정 파일**: `lunch-service/lunch.js`
- 라인 1084-1115: deletePlace 함수 개선
- 라인 694-724: submitPlace 수정 로직 개선

## 테스트 필요 사항

다음 항목들을 다시 테스트해야 합니다:

1. ✅ 태그 입력 시 마지막 글자가 남지 않는지 확인
2. ✅ 등록 탭 클릭 시 매번 비밀번호 모달이 표시되는지 확인
3. ✅ 이미지 업로드가 정상적으로 작동하는지 확인
4. ✅ 관리자 화면에서 삭제 기능이 정상 작동하는지 확인
5. ✅ 관리자 화면에서 수정 기능이 정상 작동하는지 확인
6. ✅ 관리자 화면에서 이미지 수정이 정상 작동하는지 확인

## 배포 필요

다음 파일들을 배포해야 합니다:
- `lunch-service/lunch.js`
- `lunch-service/apps-script-template.js`
